toFixed(6);
      const lng = lastLatLng.lng.toFixed(6);
      const url = https://www.google.com/maps?q=${lat},${lng};
      window.open(url, "_blank");
    });

    btnClear.addEventListener('click', () => {
      if (marker) map.removeLayer(marker);
      marker = null;
      lastLatLng = null;
      coordsEl.textContent = "—";
      btnCopy.disabled = true;
      btnGmaps.disabled = true;
      btnClear.disabled = true;
      setStatus("تم مسح الدبوس. اختاري موقع جديد.", "warn");
    });

    btnLocate.addEventListener('click', () => {
      if (!navigator.geolocation){
        setStatus("جهازك ما يدعم تحديد الموقع.", "warn");
        return;
      }
      setStatus("جاري تحديد موقعك…", "warn");
      navigator.geolocation.getCurrentPosition(
        (pos) => {
          const latlng = { lat: pos.coords.latitude, lng: pos.coords.longitude };
          map.setView(latlng, 15);
          setPoint(latlng);
          setStatus("هذا موقعك الحالي ✅ (تقدرين تعدلينه بالضغط على الخريطة)", "ok");
        },
        () => setStatus("ما قدرنا نجيب موقعك. فعّلي GPS أو جرّبي متصفح ثاني.", "warn"),
        { enableHighAccuracy: true, timeout: 10000 }
      );
    });
  </script>

</body>
</html>
